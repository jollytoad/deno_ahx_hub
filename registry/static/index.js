(()=>{var et=Object.defineProperty;var tt=(e,t)=>{for(var o in t)et(e,o,{get:t[o],enumerable:!0})};var me=!1;document.addEventListener("DOMContentLoaded",function(){me=!0},{once:!0,passive:!0});function de(e){me?e(document):document.addEventListener("DOMContentLoaded",()=>e(document),{once:!0,passive:!0})}var le={};tt(le,{controls:()=>Ct,elements:()=>it,eventsAll:()=>te,eventsNone:()=>rt,forms:()=>vt,internals:()=>ot,logger:()=>oe,loggerConfig:()=>P,owners:()=>At,slots:()=>Rt});var C=new Map,_=new Set,U=new WeakMap;function A(e,t,o){if(C.has(t)||C.set(t,new WeakMap),C.get(t).set(e,o),!U.has(e)){let r=new WeakRef(e);_.add(r),U.set(e,r)}}function d(e,t,o){return o&&!D(e,t)&&A(e,t,o()),C.get(t)?.get(e)}function D(e,t){return!!C.get(t)?.has(e)}function he(e,t){if(t)C.get(t)?.delete(e);else{for(let r of C.values())r.delete(e);let o=U.get(e);o&&(_.delete(o),U.delete(e))}}function Se(e,t){for(let[o,r]of C.entries())if(o.startsWith("triggered:")){let n=r.get(e);n!==void 0&&A(t,o,n)}}function*b(e){let t=C.get(e);if(t)for(let o of _){let r=o.deref();r&&t.has(r)&&(yield[r,t.get(r)])}}function*v(){for(let e of _){let t=e.deref();if(t)for(let[o,r]of C.entries())r.has(t)&&(yield[t,o,r.get(t)])}}function ot(){console.group("ahx internal properties...");let e;for(let[t,o,r]of v()){if(t!==e){e&&console.groupEnd();let n=t instanceof CSSRule?t.cssText:t;if(console.groupCollapsed(n),console.dir(t),t instanceof CSSStyleRule)for(let s of document.querySelectorAll(t.selectorText))console.log(s);e=t}if(r instanceof Map){console.group("%s:",o);for(let n of r)console.log("%c%s:","font-weight: bold",...n);console.groupEnd()}else console.log("%c%s:","font-weight: bold",o,r)}console.groupEnd()}var p={prefix:"ahx",httpMethods:["get","post","put","patch","delete"],ahxAttrs:["trigger","target","slot-name"],maxLoopCount:10,defaultDelay:20,defaultSettleDelay:20,defaultSwapDelay:0,enableDebugEvent:!1,pseudoChildTags:{article:"div",aside:"div",audio:"track",body:"div",canvas:null,colgroup:"col",datalist:"option",div:"div",dl:"dt",footer:"div",form:"fieldset",head:null,header:"div",hgroup:"div",html:null,iframe:null,main:"div",map:"area",menu:"li",noscript:null,object:null,ol:"li",optgroup:"option",p:"span",picture:"source",portal:null,pre:null,script:null,section:"div",select:"option",span:"span",style:null,table:"tbody",tbody:"tr",template:null,textarea:null,tfoot:"tr",thead:"tr",tr:"td",ul:"li",video:"track",area:null,base:null,br:null,col:null,embed:null,hr:null,img:null,input:null,link:null,meta:null,param:null,source:null,track:null,wbr:null,"*":"slot"}};var P={group:!1,include:[]};function te(){p.enableDebugEvent=!0,addEventListener(p.prefix,oe)}function rt(){p.enableDebugEvent=!1,removeEventListener(p.prefix,oe)}function oe({detail:e}){let{type:t,target:o,detail:r}=e;if(nt(t))if(r?._after&&P.group&&console.groupEnd(),r?._before){let n=P.group?P.group===!0?"group":"groupCollapsed":"debug";console[n]("%s -> %o %o",t,o,r)}else console.debug("%s -> %o %o",t,o,r)}function nt(e){return P.include?.length?!!P.include.some(t=>e.includes(`:${t}`)):!0}function k(e){let t=new Set;for(let o of e.style)re(o)&&t.add(o);return t}function ye(e){for(let t of e.attributes)if(ne(t.name))return!0;return!1}function re(e){return e.startsWith(`--${p.prefix}-`)}function ne(e){return e.startsWith(`${p.prefix}-`)}function st(e){return e.startsWith(`${p.prefix}-`)}function E(e){return re(e)?e:ne(e)?`--${e}`:`--${p.prefix}-${e}`}function L(e){return ne(e)?e:re(e)?e.substring(2):`${p.prefix}-${e}`}function B(e){return st(e)?e:`${p.prefix}-${e}`}function w(e){if(e instanceof Element)return e;if(e&&"ownerNode"in e&&e.ownerNode&&e.ownerNode instanceof Element)return e.ownerNode;if(e?.parentStyleSheet)return w(e.parentStyleSheet);if(e&&"ownerRule"in e)return w(e.ownerRule)}function y(e,t,o,r="tokens"){e=E(e);let n=t.style.getPropertyValue(e)?.trim();if(n){let i=/^attr\(([^\)\s,]+)(?:\s+([^\)\s,]+))?\)$/.exec(n);if(i)return o?(n=o.getAttribute(i[1])??void 0,n&&i[2]==="url"&&(n=s(n,o.baseURI)),n?[n]:[]):[n];{let c=/^--prop\(([^\)\s,]+)(?:\s+([^\)\s,]+))?\)$/.exec(n);if(c){if(!o)return[n];n=void 0;let l=o[c[1]];return c[2]==="url"&&typeof l=="string"?n=s(l,o.baseURI):(typeof l=="string"||typeof l=="number"||typeof l=="boolean")&&(n=String(l)),n?[n]:[]}}let a=/^url\(([^\)]*)\)(?:\s+url\(([^\)]*)\))*$/.exec(n);if(a){let[,...c]=a,l=t.parentStyleSheet?.href??t.style.parentRule?.parentStyleSheet?.href??o?.baseURI??w(t)?.baseURI;return c.flatMap(m=>{let h=m?s(se(m),l):void 0;return h?[h]:[]})}n=se(n)}return n?r==="tokens"?n.split(/\s+/).map(se):[n]:[];function s(i,a){try{return new URL(i,a).href}catch(c){console.error(c,i,a)}}}function se(e){let t=/^\"([^\"]*)\"$/.exec(e)??/^\'([^\']*)\'$/.exec(e);return t?t[1]:e}function O(e,t,o="tokens"){e=L(e);let r=t.getAttribute(e)??void 0;return r?o==="tokens"?r.split(/\s+/):[r]:[]}function g(e,t,o="tokens"){return t instanceof Element?O(e,t,o):y(e,t,void 0,o)}function T(e,t){if(e===t)return 0;let o=e.compareDocumentPosition(t);return o&Node.DOCUMENT_POSITION_FOLLOWING||o&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:o&Node.DOCUMENT_POSITION_PRECEDING||o&Node.DOCUMENT_POSITION_CONTAINS?1:0}function it(e){console.group("ahx elements...");let t=new Set,o=new Set;for(let[r]of v())r instanceof Element?t.add(r):r instanceof CSSStyleRule&&o.add(r);for(let r of o)for(let n of document.querySelectorAll(r.selectorText))n instanceof Element&&t.add(n);for(let r of[...t].sort(T))if(e){let n=O(e,r);n.length&&console.log(r,...n)}else console.log(r);console.groupEnd()}function K(e,t,o,r=!0){if(e!==null){let n=new CustomEvent(t,{bubbles:!!e,cancelable:r,detail:o});return p.enableDebugEvent&&dispatchEvent(new CustomEvent(p.prefix,{bubbles:!1,cancelable:!1,detail:{type:n.type,target:e,bubbles:n.bubbles,cancelable:n.cancelable,detail:n.detail}})),e&&"dispatchEvent"in e?e.dispatchEvent(n):dispatchEvent(n)}return!1}function F(e,t,o){K(e,`${p.prefix}:${t}`,o,!1)}function f(e,t,o){o._before=!0;let r=K(e,`${p.prefix}:${t}`,o);return delete o._before,r||K(e,`${p.prefix}:${t}:veto`,o,!1),r}function u(e,t,o){o._after=!0,K(e,`${p.prefix}:${t}:done`,o,!1),delete o._after}function R(e,t,o){K(e,`${p.prefix}:${t}:error`,{error:t,...o},!1)}function j(e,t){return at(e,t,!1)}function at(e,t,o){if(!t)return s();let[r,n]=lt(t);switch(r){case"this":return s(e);case"closest":return s(e.closest(n));case"find":return o?e.querySelectorAll(n):e.querySelector(n)??void 0;case"next":return s(ct(e,n));case"previous":return s(pt(e,n));case"body":return s(e.ownerDocument.body);case"document":case"window":return s();default:return o?e.ownerDocument.querySelectorAll(t):e.ownerDocument.querySelector(t)??void 0}function s(i){return o?i?[i]:[]:i??void 0}}function lt(e){let t=e.indexOf(" ");return t===-1?[e,""]:[e.substring(0,t),e.substring(t+1)]}function ct(e,t){for(let o of e.ownerDocument.querySelectorAll(t))if(o.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_PRECEDING)return o}function pt(e,t){let o=e.ownerDocument.querySelectorAll(t);for(let r=o.length-1;r>=0;r--){let n=o[r];if(n.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING)return n}}async function*ft(){let e=this.getReader();try{let t,o;do({done:t,value:o}=await e.read()),o!==void 0&&(yield o);while(!t)}finally{e.releaseLock()}}ReadableStream.prototype[Symbol.asyncIterator]??=ft;var G=class extends TransformStream{constructor(t,o){let r,n;super({start(){r=t.implementation.createHTMLDocument()},transform(s,i){if(r.write(s),!n&&r.body?.childElementCount>0){let a=r.body.children[0];o&&a instanceof HTMLTemplateElement?n=a.content:n=r.body}for(;n?.childElementCount>1;){let a=n.children[0];t.adoptNode(a),i.enqueue(a)}},flush(s){for(let i of[...n?.children??[]])t.adoptNode(i),s.enqueue(i);r.close(),r=void 0,n=void 0}})}};function S(e){if(D(e,"owner"))return d(e,"owner");if(e instanceof StyleSheet)return d(e,"owner")??e.href??void 0;if(e instanceof CSSRule&&e.parentStyleSheet)return S(e.parentStyleSheet);if(e instanceof Element&&e.parentElement)return S(e.parentElement)}function N(e,t){t!==S(e)&&A(e,"owner",t)}function ge(e,t){let[o,r]=ut(e),n=[];for(let[s,i]of b("slotName"))i.has(o)&&(s instanceof Element?n.push(s):s instanceof CSSStyleRule&&n.push(...t.querySelectorAll(s.selectorText)));return r&&(n=n.filter(s=>s.matches(r))),n}function ut(e){let t=e.indexOf(" ");return t===-1?[e,""]:[e.substring(0,t),e.substring(t+1)]}async function xe(e){let{response:t,target:o}=e,r=o.ownerDocument;if(t?.ok&&t.headers.get("Content-Type")?.startsWith("text/html")&&t.body){let n=0,s,i=!1,a=t.body.pipeThrough(new TextDecoderStream).pipeThrough(new G(r,!0));for await(let c of a){switch(c.localName){case`${p.prefix}-replace-previous`:i=!0;continue;case`${p.prefix}-flush`:continue}let l=e.swapStyle??"none",m=[o],[h]=O("slot",c,"whole");if(h){let I=ge(h,r);I.length?(m=I,l="inner"):l="none"}let x=m.length?c:void 0;for(let I of m){x&&(c=x.cloneNode(!0));let q={...e,swapStyle:l,target:I,element:c,previous:s,index:n,slot:h};if(f(I,"swap",q)){let{target:pe,element:H,controlOwner:fe,swapStyle:Ze,slot:ue}=q;fe&&N(H,fe),ue||!s?mt[Ze]?.(pe,H):s&&i?s.replaceWith(H):s.after(H),ue||(s=H),u(pe,"swap",q)}}n++}}}var Q=e=>(t,o)=>{t.insertAdjacentElement(e,o)},mt={none(){},inner(e,t){typeof Idiomorph<"u"?Idiomorph.morph(e,t,{morphStyle:"innerHTML",ignoreActiveValue:!0}):e.replaceChildren(t)},outer(e,t){let o=`${p.prefix}-pseudo`;for(let r of e.classList)r.startsWith(o)&&t.classList.add(r);Se(e,t),typeof Idiomorph<"u"?Idiomorph.morph(e,t,{morphStyle:"outerHTML",ignoreActiveValue:!0}):e.replaceWith(t)},beforebegin:Q("beforebegin"),afterbegin:Q("afterbegin"),beforeend:Q("beforeend"),afterend:Q("afterend")};function Ee(e){let{target:t,itemName:o,merge:r,separator:n}=e,s={...e};if(s.oldValue=t.getAttribute(o)??void 0,r==="join"&&s.oldValue&&s.value&&(s.value=dt(s.oldValue,s.value,n)),f(t,"swap",s)){let{target:i,itemName:a,value:c}=s;a&&c!==void 0&&i.setAttribute(a,c),u(i,"swap",s)}}function dt(e,t,o=" "){let r=new Set(`${e}${o}${t}`.split(o));return r.delete(""),[...r].join(o)}function Ce(e){let{target:t,itemName:o,merge:r,separator:n,value:s}=e;if(!o||s===void 0)return;let i={...e};if(t instanceof HTMLFormElement)switch(i.input=t.elements.namedItem(o)??void 0,r){case"append":i.input=we(o,t.ownerDocument);break;default:i.input?"value"in i.input&&(i.oldValue=i.input.value):i.input=we(o,t.ownerDocument);break}else{i.formData=d(t,"formData",()=>new FormData);let a=i.formData.get(o);typeof a=="string"&&(i.oldValue=a)}if(r==="join"&&(i.value=ht(i.oldValue,i.value,n)),f(t,"swap",i)){let{target:a,input:c,itemName:l,merge:m,formData:h,value:x}=i;l&&x!==void 0&&(c&&"value"in c?(c.value=x,c instanceof Element&&!c.parentElement&&a.insertAdjacentElement("beforeend",c)):h&&(m==="append"?h.append(l,x):h.set(l,x))),u(a,"swap",i)}}function we(e,t){let o=t.createElement("input");return o.type="hidden",o.name=e,o}function ht(e="",t="",o=" "){let r=new Set(`${e}${o}${t}`.split(o));return r.delete(""),[...r].join(o)}function Ae(e){let{swapStyle:t}=e;switch(t){case"input":return Ce(e);case"attr":return Ee(e)}}async function J(e){let{swapStyle:t,response:o,itemName:r}=e,{value:n}=e;switch(t){case"input":case"attr":return r?(n===void 0&&o&&(n=await o.text()),Ae({...e,swapStyle:t,itemName:r,value:n})):void 0;default:if(St(o))return xe({...e,swapStyle:t??"none",response:o})}}function St(e){return!!e?.headers.get("Content-Type")?.startsWith("text/html")&&!!e.body}function be(e,t){if(e instanceof CSSStyleRule){let[o]=y("headers",e,t,"whole");try{let r=JSON.parse(o);return new Headers(r)}catch{R(t,"invalidCssValue",{prop:E("headers"),value:o,rule:e,reason:"Must be a valid JSON object of request headers"})}}}async function ve(e){let{source:t,action:o,target:r,swap:n,controlOwner:s,targetOwner:i}=e;if(o.type!=="request")return;let a=yt({...e,action:o});if(!a)return;let c={request:a};if(f(t,"request",c)){let{request:l}=c;try{let m=await fetch(l);if(u(t,"request",{request:l,response:m}),m.headers.has(B("refresh"))){let h={...e,request:l,response:m,refresh:!0,url:new URL(location.href)};if(f(t,"navigate",h)){location.reload();return}}await J({...n,target:r,response:m,controlOwner:s,targetOwner:i})}catch(m){u(t,"request",{request:l,error:m})}}}function yt(e){let{action:t,formData:o,source:r,control:n}=e;if(!t.url){R(r,"invalidRequest",{action:t,reason:"Missing URL"});return}let s=new URL(t.url),i=be(n,r)??new Headers,a={method:t.method.toUpperCase(),headers:i};if(i.has("Accept")||i.set("Accept","text/html,application/xhtml+xml,text/plain;q=0.9"),i.set(B("request"),"true"),i.set(B("current-url"),r.ownerDocument.location.href),o)switch(a.method){case"GET":case"HEAD":case"DELETE":for(let[c,l]of o)typeof l=="string"&&s.searchParams.append(c,l);break;case"PUT":case"POST":case"PATCH":gt(o)?(a.body=o,i.set("Content-Type","multipart/form-data")):(a.body=new URLSearchParams(o),i.set("Content-Type","application/x-www-form-urlencoded"))}return new Request(s,a)}function gt(e){for(let t of e.values())if(t instanceof File)return!0;return!1}async function Te(e){let{event:t,source:o,action:r,target:n,swap:s,control:i,sourceOwner:a,controlOwner:c,targetOwner:l}=e;if(!(i instanceof CSSStyleRule)||r.type!=="harvest")return;let[m]=y("harvest",i,o);if(m===void 0)return;let h=xt(t),x={source:o,oldValue:h,newValue:m,control:i,sourceOwner:a,targetOwner:l,controlOwner:c};f(o,"harvest",x)&&(await J({...s,target:n,value:x.newValue}),u(o,"harvest",x))}function xt(e){if(e instanceof CustomEvent&&"oldValue"in e.detail)return e.detail.oldValue}async function Re(e){let{source:t,action:o,target:r,control:n,sourceOwner:s,controlOwner:i,targetOwner:a}=e;if(!(n instanceof CSSStyleRule)||o.type!=="dispatch")return;let[c]=y("dispatch",n,t);if(!c)return;let l={source:t,target:r,control:n,sourceOwner:s,targetOwner:a,controlOwner:i,event:new CustomEvent(c,{bubbles:!0,cancelable:!0,detail:{}})};if(f(t,"dispatch",l)){let m=!r.dispatchEvent(l.event);u(t,"dispatch",{...l,cancelled:m})}}async function z(e){let{source:t,control:o,action:r}=e,[n]=g("include",o,"whole"),s=j(t,n);if(e.formData=s?Et(s):void 0,r.type==="request"&&o instanceof CSSStyleRule&&r.url===void 0){let[i]=y(r.method,o,t);i&&(e.action={...r,url:new URL(i,t.baseURI)})}if(f(t,"action",e)){switch(e.action.type){case"request":await ve(e);break;case"harvest":await Te(e);break;case"dispatch":await Re(e);break}u(t,"action",e)}}function Et(e){if(D(e,"formData"))return d(e,"formData");if(e instanceof HTMLFormElement)return new FormData(e)}var ie=new Set;function De(e){f(e.source,"queue",e)&&ie.add(e)}function Ne(e){ie.delete(e),u(e.source,"queue",e)}function Pe(){return ie.values()}function Ie(e){let{control:t,trigger:o,source:r}=e;if(ae(r)){R(r,"triggerDenied",e);return}if(o?.once&&d(r,`triggered:${o.eventType}`)?.has(t))return;o?.changed,f(r,"trigger",e)&&(o?.once&&d(r,`triggered:${o.eventType}`,()=>new WeakSet).add(t),o?.throttle||(o?.delay?setTimeout(n,o.delay):setTimeout(n,0)),u(r,"trigger",e));function n(){wt(e)?z(e):De(e)}}function ae(e){let[t]=g("deny-trigger",e);return t==="true"}function wt(e){return e.target instanceof Element}function Ct(e=!1){console.group("ahx controls...");let t=new Map;function o(n,s,i){t.has(n)||t.set(n,new Map),t.get(n).set(i,s)}for(let[n,s,i]of v())if(s.startsWith("control:")){if(n instanceof Element)o(n,n,i);else if(n instanceof CSSStyleRule)for(let a of document.querySelectorAll(n.selectorText))a instanceof Element&&o(a,n,i)}let r=[...t.keys()].sort(T);for(let n of r){let s=t.get(n)??[],i=new Set,a=ae(n);for(let[{trigger:c}]of s)i.add(c.eventType);console.groupCollapsed("%o : %c%s",n,a?"text-decoration: line-through; color: grey":"color: red",[...i].join(", "));for(let[{trigger:c,action:l,swap:m},h]of s)if(e)console.log("trigger:",c,"action:",l,"swap:",m,"control:",h);else{let x=h instanceof Element?"element":h.cssText,I="method"in l?`${l.method.toUpperCase()} ${l.url}`:l.type,q=(m?.swapStyle??"default")+(m?.itemName?` ${m.itemName}`:"");console.log("%c%s%c -> %c%s%c -> %c%s%c from: %c%s%c","color: red; font-weight: bold",c.eventType,"color: inherit; font-weight: normal","color: green",I,"color: inherit","color: darkorange",q,"color: inherit","color: hotpink",x,"color: inherit")}console.groupEnd()}console.groupEnd()}function At(){console.group("ahx ownership...");let e=new Set;for(let[t,o,r]of v())t instanceof Element?e.add(t):o==="owner"&&(t instanceof CSSRule?console.log("%o -> %s",t.cssText,r):console.log("%o -> %s",t,r));for(let t of[...e].sort(T)){let o=d(t,"owner");console.log("%o -> %s",t,o??"none")}console.groupEnd()}function Y(e){return!!e.parentStyleSheet&&!e.parentStyleSheet.disabled}var bt=0;function Oe(e){return d(e,"ruleId",()=>`${++bt}`)}function $(e,t){let[o]=g("target",t,"whole"),r=/^await\s+/.test(o);r&&(o=o.substring(5).trimStart());let n=j(e,o);return r?n??"await":n??e}function vt(){console.group("ahx form...");let e=new Set;for(let[t]of b("formData"))t instanceof Element&&e.add(t);for(let[t]of Tt("harvest"))for(let o of document.querySelectorAll(t.selectorText)){let r=$(o,t);r instanceof Element&&e.add(r)}for(let t of[...e].sort(T)){let o=t instanceof HTMLFormElement?new FormData(t):d(t,"formData");if(o){console.group(t);for(let[r,n]of o??[])console.log("%s: %c%s",r,"font-weight: bold",n);console.groupEnd()}}console.groupEnd()}function*Tt(e){for(let[t,o,r]of v())o.startsWith("control:")&&t instanceof CSSStyleRule&&typeof r=="object"&&"action"in r&&r.action.type===e&&Y(t)&&(yield[t,r])}function Rt(){console.group("ahx slots...");let e=new Map;function t(o,r){let n=e.get(o)??e.set(o,new Set).get(o);r.forEach(s=>n.add(s))}for(let[o,r]of b("slotName"))if(o instanceof Element)t(o,r);else if(o instanceof CSSStyleRule){let n=document.querySelectorAll(o.selectorText);for(let s of n)t(s,r)}for(let o of[...e.keys()].sort(T))console.log(o,...e.get(o));console.groupEnd()}function ke(e){let[t]=g("trigger",e,"whole"),o=[];if(t){let r=t.split(/\s*,\s*/);for(let n of r){let[s,...i]=n.split(/\s+/);if(s){let a={eventType:s};for(let c of i)switch(c){case"once":a[c]=!0;break}o.push(a)}}}return o}function Le(e){let t=[];for(let o of p.httpMethods){let[r]=g(o,e);r&&t.push({type:"request",method:o,url:Dt(r,e)})}if(e instanceof CSSStyleRule){let o=k(e);o.has(E("harvest"))&&t.push({type:"harvest"}),o.has(E("dispatch"))&&t.push({type:"dispatch"})}return t}function Dt(e,t){let o=t instanceof Element?t.baseURI:void 0;try{return new URL(e,o)}catch{return}}function $e(e){if(e!=null)return e.slice(-2)=="ms"?parseFloat(e.slice(0,-2))||void 0:e.slice(-1)=="s"?parseFloat(e.slice(0,-1))*1e3||void 0:e.slice(-1)=="m"?parseFloat(e.slice(0,-1))*1e3*60||void 0:parseFloat(e)||void 0}function Me(e){let t=g("swap",e,"tokens"),o={};if(t?.length){o.swapStyle=t.shift()?.toLowerCase(),(o.swapStyle==="attr"||o.swapStyle==="input")&&(o.itemName=t.shift());for(let r of t){let[n,s]=r.split(":");switch(n){case"swap":case"delay":o.delay=$e(s);break;case"join":o.merge="join",o.separator=Nt(s);break;case"append":o.merge="append";break}}}return o}function Nt(e=" "){switch(e){case"space":return" ";case"comma":return",";default:return e}}var Pt=new Set(["load","mutate"]);function Ve(e){return Pt.has(e)?`${p.prefix}:${e}`:e}function qe(e){let t=`${p.prefix}:`;return e.startsWith(t)?e.substring(t.length):e}function*It(e,t,o){let r=d(t,`control:${e}`);if(r&&(yield[t,t,r]),o)for(let[n,s]of b(`control:${e}`))n instanceof Element&&t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(yield[n,n,s])}function*Ot(e,t,o){for(let[r,n]of b(`control:${e}`))if(n&&r instanceof CSSStyleRule&&Y(r)&&(t.matches(r.selectorText)&&(yield[t,r,n]),o))for(let s of t.querySelectorAll(r.selectorText))yield[s,r,n]}function*He(e,t,o){yield*It(e,t,o),yield*Ot(e,t,o)}var Ke=new Set;function We(e){if(!Ke.has(e)){let t={eventType:e};f(void 0,"addEventType",t)&&(Ke.add(e),addEventListener(Ve(e),kt),u(void 0,"addEventType",t))}}function kt(e){for(let t of Lt(e))Ie(t)}function*Lt(e){if(e.target instanceof Element){let t=He(qe(e.type),e.target,$t(e));for(let[o,r,n]of t){let s=$(o,r);yield{...n,event:e,source:o,sourceOwner:S(o),target:s,targetOwner:s!=="await"?S(s):void 0,control:r,controlOwner:S(r)}}}}function $t(e){return e instanceof CustomEvent&&!!e.detail?.recursive}function Ue(e){let t=w(e.control);if(f(t,"processControl",e)){let{control:o,trigger:r,action:n,swap:s}=e,{eventType:i}=r;A(o,`control:${i}`,{trigger:r,action:n,swap:s}),We(i),u(t,"processControl",e)}}function X(e){let t=ke(e),o=Le(e),r=Me(e);for(let n of t)for(let s of o)Ue({control:e,trigger:n,action:s,swap:r})}function Z(e){let t=g("slot-name",e,"tokens");if(t.length){let o=d(e,"slotName",()=>new Set);t.forEach(r=>o.add(r))}}function W(e){if(ye(e)){let t={owner:S(e)};f(e,"processElement",t)&&(t.owner&&N(e,t.owner),X(e),Z(e),u(e,"processElement",t))}}function ee(e){let t=new Set;[...p.ahxAttrs,...p.httpMethods].forEach(r=>{t.add(`[${L(r)}]`)});let o={selectors:t};if(f(e,"processElements",o)){let r=new Set;for(let n of o.selectors){!r.has(e)&&e instanceof Element&&e.matches(n)&&(r.add(e),W(e));for(let s of e.querySelectorAll(n))r.has(s)||(r.add(s),W(s))}u(e,"processElements",o)}}function _e(e){F(e,"mutate",{})}function M(e){F(e,"load",{recursive:!0})}function Be(e,t){let o=E("deny-trigger");if(t.has(o)){let[r]=y(o,e);r==="true"?A(e,"denyTrigger",!0):(e.style.removeProperty(o),R(e.parentStyleSheet?.ownerNode??document,"invalidCssValue",{prop:o,value:r,rule:e}))}return[]}var Mt=1;function Fe(e){let t=e.selectorText.includes("::before"),o=t?!1:e.selectorText.includes("::after");if(t||o){let r=d(e,"pseudoId")||Mt++,n=t?"before":"after",s=e.selectorText.replace(`::${n}`,"");for(let i of document.querySelectorAll(s))Vt(i,r,n);return qt(e,r,n)}}function Vt(e,t,o){let r=`${p.prefix}-pseudo-${t}`;if(!e.querySelector(`:scope > .${r}`)){let n=e.localName,s=p.pseudoChildTags[n];if(s===null){R(e,"pseudoElementNotPermitted",{parentTag:n});return}s===void 0&&(s=p.pseudoChildTags["*"]??"span");let i=`${p.prefix}-pseudo-${o}`,a=document.createElement(s);a.setAttribute("class",`${p.prefix}-pseudo ${i} ${r}`);let c={pseudoElt:a,pseudoId:t,place:o};if(f(e,"pseudoElement",c)){let l=c.place==="before"?"afterbegin":"beforeend";e.insertAdjacentElement(l,c.pseudoElt),u(e,"pseudoElement",c)}}}function qt(e,t,o){if(!D(e,"pseudoId")){A(e,"pseudoId",t);let r=`${p.prefix}-pseudo-${t}`,n=e.selectorText.replace(`::${o}`,` > .${r}`),s=e.cssText.replace(e.selectorText,n),i={selectorText:n,cssText:s,parentStyleSheet:e.parentStyleSheet},a={pseudoId:t,pseudoRule:i,rule:e,place:o,owner:S(e)},c=w(e)??document;if(f(c,"pseudoRule",a)){let l=a.pseudoRule.parentStyleSheet;if(l){let m=l.cssRules,h=m[l.insertRule(a.pseudoRule.cssText,m.length)];return!a.owner&&l.href&&(a.owner=l.href),a.owner&&N(h,a.owner),u(c,"pseudoRule",{...a,pseudoRule:h}),h}}}}function je(e,t){let o=!!w(e)?.ownerDocument?.querySelector(e.selectorText),r=y("import",e);for(let n of r){let s=d(e,"importLinks")?.get(n)?.deref();s?o&&s.sheet?.disabled?(s.sheet.disabled=!1,setTimeout(()=>{t?.(s)},0)):!o&&s.sheet&&(s.sheet.disabled=!0):o&&(s=Ht(n,w(e)?.crossOrigin??void 0,t),s&&d(e,"importLinks",()=>new Map).set(n,new WeakRef(s)))}}function Ht(e,t,o){let r={url:e,crossOrigin:t,disabled:!1};if(f(document,"cssImport",r)&&!document.querySelector(`link[rel="stylesheet"][href="${r.url}"]`)){let n=document.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",r.url),typeof r.crossOrigin=="string"&&n.setAttribute("crossorigin",r.crossOrigin),n.addEventListener("load",s=>{function i(a=1){setTimeout(()=>{n.sheet?(u(s.target??document,"cssImport",r),o?.(n)):a<1e3?i(a*2):console.error("ahx timeout loading stylesheet:",r.url,n.sheet)},a)}i()},{once:!0,passive:!0}),document.head.appendChild(n),n}}function ce(e,t){let o=Oe(e);if(e.parentStyleSheet&&Kt(e.parentStyleSheet),t.size){let r=S(e),n={rule:e,props:t,owner:r},s=w(e)??document;if(f(s,"processRule",n)){n.owner&&N(e,n.owner),Ut(e,o,t),je(e,Wt),Be(e,t);let i=Fe(e);i&&ce(i,k(i)),X(e),Z(e),u(s,"processRule",n)}}}function Kt(e){D(e,"owner")||N(e,e.href??"unknown")}function Wt(e){V(e),M(e.ownerDocument.documentElement)}function Ut(e,t,o){let r=E("rule");o.has(r)||e.style.setProperty(r,t);let n=E(`rule-${t}`);o.has(n)||e.style.setProperty(n,t)}function V(e){let t={rules:_t(e)};if(f(e,"processRules",t)){for(let[o,r]of t.rules)ce(o,r);u(e,"processRules",t)}}function _t(e){let t=new Map;function o(s){if(!s.disabled)try{r(s.cssRules)}catch{}}function r(s){for(let i of s)i instanceof CSSImportRule&&i.styleSheet&&o(i.styleSheet),i instanceof CSSStyleRule&&n(i),i instanceof CSSGroupingRule&&i.cssRules.length&&r(i.cssRules)}function n(s){let i=k(s);i.size>0&&t.set(s,i)}if("sheet"in e&&e.sheet)o(e.sheet);else if("styleSheets"in e)for(let s of e.styleSheets)o(s);return t}function Ge(){for(let e of Pe()){let t=$(e.source,e.control);t instanceof Element&&(Ne(e),z({...e,target:t,targetOwner:S(t)}))}}function Qe(e){let t=new MutationObserver(r=>{let n={mutations:r};if(f(e,"mutations",n)){let s=new Set,i=new Set,a=new Set,c=new Set;for(let l of n.mutations){for(let m of l.removedNodes)s.add(m),m instanceof Element&&i.add(m);for(let m of l.addedNodes)s.delete(m),m instanceof Element&&(ee(m),a.add(m));l.type==="attributes"&&l.target instanceof Element&&W(l.target),l.target instanceof Element&&c.add(l.target)}setTimeout(()=>{for(let l of c)_e(l)},0),setTimeout(()=>{for(let l of a)M(l)}),V(e),Ge(),u(e,"mutations",{...n,removedElements:i,addedElements:a,mutatedElements:c});for(let l of s)Je(l)}}),o={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0};f(e,"startObserver",o)&&(t.observe(e,o),u(e,"startObserver",o))}function Je(e){he(e);for(let t of e.childNodes)Je(t)}function Bt(e,t){e&&e.getAttribute(`${p.prefix}-url-href`)!==t.href&&(o("href",t.href),o("host",t.host),o("path",t.pathname),o("search",t.search),o("hash",t.hash));function o(r,n){let s=`${p.prefix}-url-${r}`;n?e.setAttribute(s,n):e.removeAttribute(s)}}function ze(e){function t(){Bt(e.documentElement,e.location)}["DOMContentLoaded","load","hashchange","popstate"].forEach(o=>{addEventListener(o,t)}),t()}function Ye(e){let t=L("debug-events"),o=e.querySelector(`[${t}]`);o&&(P.include=O(t,o),te())}function Xe(e){Ye(e),ze(e),Qe(e),V(e),ee(e),M(e.documentElement)}de(Xe);window.ahx=le;})();
//# sourceMappingURL=index.js.map
